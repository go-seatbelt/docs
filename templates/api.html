{{ template "components/header" . }}

<div class="">
  <div class="relative hidden md:block w-64 ml-6 mt-4">
    <div class="bg-slate-100 fixed rounded-lg px-4 py-6">
      <h2 class="text-lg font-bold mb-6">seatbelt.App</h2>
      <a href="/api#seatbelt.App" class="js-toc js-one block mb-4 text-sm font-mono hover:underline">type seatbelt.App</a>
      <a href="/api#seatbelt.New" class="js-toc js-two block mb-4 text-sm font-mono hover:underline">func seatbelt.New</a>
      <a href="/api#seatbelt.Start" class="js-toc js-three block mb-4 text-sm font-mono hover:underline">func app.Start</a>
      <a href="/api#seatbelt.Use" class="js-toc js-four block mb-4 text-sm font-mono hover:underline">func app.Use</a>
      <a href="/api#seatbelt.UseStd" class="js-toc js-five block mb-4 text-sm font-mono hover:underline">func app.UseStd</a>
      <a href="/api#seatbelt.SetErrorHandler" class="js-toc js-six block mb-4 text-sm font-mono hover:underline">func app.SetErrorHandler</a>
      <a href="/api#seatbelt.Namespace" class="js-toc js-seven block mb-4 text-sm font-mono hover:underline">func app.Namespace</a>
    </div>
  </div>

  <div class="pl-0 md:pl-72 mt-10">
    <main class="max-w-3xl p-6">
      <h1 class="text-3xl sm:text-6xl font-extrabold tracking-tight mb-12 text-pink-500">API Reference</h1>

      <section class="mb-16">
        <div class="group flex items-center text-sm sm:text-xl font-semibold mb-4">
          <h3 id="seatbelt.App" class="js-symbol-title js-one font-mono">
            <a name="seatbelt.App">{{ highlight "go" "type seatbelt.App" }}</a>
          </h3>

          <div class="invisible group-hover:visible ml-2">
            <a href="#seatbelt.App" class="block">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
              </svg>
            </a>
          </div>
        </div>

        <p class="text-slate-600 text-base leading-relaxed mb-4">A <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">*seatbelt.App</code> is the core of your application. It contains routing and middleware information, stores templates and internationalization data, and manages sessions and flashes.</p>
        <p class="text-slate-600 text-base leading-relaxed mb-4">It is not an HTTP server. While it does provide a <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">Start()</code> method for convenience, it is not intended for production use. Instead, you should create an instance of a <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">*http.Server</code>, and pass the <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">*seatbelt.App</code> as its <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">Handler</code>.</p>

        <div>
          <pre class="text-sm rounded-lg px-4 py-2.5 bg-slate-100 text-slate-900 overflow-x-scroll"><code>{{ highlight "go" `package main

import (
    "net/http"

    "github.com/go-seatbelt/seatbelt"
)

func main() {
    app := seatbelt.New()

    srv := &http.Server{
		    Addr:         ":3000",
		    Handler:      app,
		    ReadTimeout:  30 * time.Second,
		    WriteTimeout: 20 * time.Second,
    }

    log.Fatalln(srv.ListenAndServe())
}` }}</code></pre>
        </div>
      </section>

      <section class="mb-16">
        <div class="group flex items-center text-sm sm:text-xl font-semibold mb-4">
          <h3 id="seatbelt.New" class="js-symbol-title js-two font-mono">
            <a name="seatbelt.New">{{ highlight "go" "func seatbelt.New(opts ...seatbelt.Opts) *seatbelt.App" }}</a>
          </h3>

          <div class="invisible group-hover:visible ml-2">
            <a href="#seatbelt.New" class="block">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
              </svg>
            </a>
          </div>
        </div>

        <p class="text-slate-600 text-base leading-relaxed mb-4">Use <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">seatbelt.New</code> to create and configure a new instance of a <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">*seatbelt.App</code> using the given <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">seabelt.Opts</code> to configure it. The following options are available:</p>
        <ul class="list-outside list-disc text-slate-600 text-base leading-relaxed pl-12 mb-4">
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">{{ highlight "go" "TemplateDir string" }}</code> The directory containing your HTML templates. Defaults to <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">"templates"</code>.</li>
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">LocaleDir <span class="text-sky-600">string</span></code> The directory containing your translation files. Defaults to an empty string, which disables translation support in your application.</li>
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">SigningKey <span class="text-sky-600">string</span></code> The secret key used to sign the session cookie. Defaults to an empty string. Setting an empty string will cause Seatbelt to generate a <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">master.key</code> file at the root of your application, which Seatbelt picks up and uses to sign sessions. This generated secret is used for convenience in development only. Do not put this secret under source control, and set this value automatically by setting the <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">SECRET</code> environment variable in production.</li>
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">SessionName <span class="text-sky-600">string</span></code> The name of the session cookie. Defaults to <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">"_session"</code>.</li>
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">SessionMaxAge <span class="text-sky-600">int</span></code> The max age that the session cookie is valid. Defaults to 365 days. Pass <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">-1</code> if you want the session to never expire.</li>
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">Reload <span class="text-sky-600">bool</span></code> Whether to reload the HTML templates and translation data from the filesystem on each request. Defaults to <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">false</code>. This is provided as a convenience in development, but significantly impacts performance. Do not enable this in production.</li>
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">SkipServeFiles <span class="text-sky-600">bool</span></code> When true, this stops Seatbelt from serving static files from the <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">public</code> folder. Defaults to <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">false</code>, meaning that static files are served by default.</li>
          <li class="mb-3"><code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">{{ highlight "go" "Funcs func(w http.ResponseWriter, r *http.Request) template.FuncMap" }}</code> HTML template functions to call from your templates. Defaults to <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">nil</code>, but please see the list of default functions.</li>
        </ul>

        <pre class="text-sm rounded-lg px-4 py-2.5 bg-slate-100 text-slate-900 overflow-x-scroll"><code>{{ highlight "go" `package main

import (
    "html/template"
    "net/http"
    "os"

    "github.com/go-seatbelt/seatbelt"
)

func main() {
    app := seatbelt.New(seatbelt.Option{
        TemplateDir:    "templates",
        LocaleDir:      "locales",
        SigningKey:     os.Getenv("SECRET"),
        SessionName:    "_seatbelt",
        SessionMaxAge:  int(30 * 24 * time.Hour),
        Reload:         false,
        SkipServeFiles: false,
        Funcs: func(w http.ResponseWriter, r *http.Request) template.FuncMap {
            return template.FuncMap{
                "CurrentPath": func(path string) bool {
                    return r.URL.Path == path
                },
            }
        },
    })
}` }}</code></pre>
      </section>

      <section class="mb-16">
        <div class="group flex items-center text-sm sm:text-xl font-semibold mb-4">
          <h3 id="seatbelt.Start" class="js-symbol-title js-three font-mono">
            <a name="seatbelt.Start">{{ highlight "go" "func (app *seatbelt.App) Start(port string) error" }}</a>
          </h3>

          <div class="invisible group-hover:visible ml-2">
            <a href="#seatbelt.Start" class="block">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
              </svg>
            </a>
          </div>
        </div>

        <p class="text-slate-600 text-base leading-relaxed mb-4">The method <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">Start()</code> is a convenience method for starting an HTTP server that runs your application.</p>
        <p class="text-slate-600 text-base leading-relaxed mb-4">The started HTTP server is not suited for production use. Instead, you should create an instance of an <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">*http.Server</code>, and pass the <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">*seatbelt.App</code> as its <code class="inline-block bg-slate-100 px-1 rounded-md text-sm sm:text-base">Handler</code>.</p>

        <div>
          <pre class="text-sm rounded-lg px-4 py-2.5 bg-slate-100 text-slate-900 overflow-x-scroll"><code>{{ highlight "go" `package main

import "github.com/go-seatbelt/seatbelt"

func main() {
    app := seatbelt.New()
    // Starts an HTTP server on http://localhost:3000
    app.Start(":3000")
}` }}</code></pre>
        </div>
      </section>

      <section class="mb-16">
        <div class="group flex items-center text-sm sm:text-xl font-semibold mb-4">
          <h3 id="seatbelt.Use" class="js-symbol-title js-four font-mono">
            <a name="seatbelt.Use">{{ highlight "go" "func (app *seatbelt.App) Use(middleware ...seatbelt.MiddlewareFunc)" }}</a>
          </h3>

          <div class="invisible group-hover:visible ml-2">
            <a href="#seatbelt.Use" class="block">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
              </svg>
            </a>
          </div>
        </div>

        <p class="text-slate-600 text-base leading-relaxed mb-4">Registers HTTP middleware on the application.</p>

        <div>
          <pre class="text-sm rounded-lg px-4 py-2.5 bg-slate-100 text-slate-900 overflow-x-scroll"><code>{{ highlight "go" `package main

import (
	"log"

	"github.com/go-seatbelt/seatbelt"
)

// logger is HTTP middleware that logs the path of the current request.
func logger(fn func(c *seatbelt.Context) error) func(*seatbelt.Context) error {
	return func(c *seatbelt.Context) error {
		log.Println("received request:", c.Request().URL.Path)
		return fn(c)
	}
}

func main() {
	app := seatbelt.New()
	app.Use(logger)
}` }}</code></pre>
        </div>
      </section>

      <section class="mb-16">
        <div class="group flex items-center text-sm sm:text-xl font-semibold mb-4">
          <h3 id="seatbelt.UseStd" class="js-symbol-title js-five font-mono">
            <a name="seatbelt.UseStd">{{ highlight "go" "func (app *seatbelt.App) UseStd(middleware ...func(http.Handler) http.Handler)" }}</span></a>
          </h3>

          <div class="invisible group-hover:visible ml-2">
            <a href="#seatbelt.UseStd" class="block">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
              </svg>
            </a>
          </div>
        </div>

        <p class="text-slate-600 text-base leading-relaxed mb-4">Registers standard library compatible HTTP middleware on the application.</p>
      </section>

      <section class="mb-16">
        <div class="group flex items-center text-sm sm:text-xl font-semibold mb-4">
          <h3 id="seatbelt.SetErrorHandler" class="js-symbol-title js-six font-mono">
            <a name="seatbelt.SetErrorHandler">{{ highlight "go" "func (a *seatbelt.App) SetErrorHandler(fn func(c *seatbelt.Context, err error))" }}</a>
          </h3>

          <div class="invisible group-hover:visible ml-2">
            <a href="#seatbelt.SetErrorHandler" class="block">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
              </svg>
            </a>
          </div>
        </div>

        <p class="text-slate-600 text-base leading-relaxed mb-4">Sets the given function as the application-wide error handler. When this handler isn't set, the default behaviour is to log the error, and either reply with the error (for idempotent request) or redirect to the referrer with a flash message containing the error (for all other requests).</p>
      </section>

      <section class="mb-16">
        <div class="group flex items-center text-sm sm:text-xl font-semibold mb-4">
          <h3 id="seatbelt.Namespace" class="js-symbol-title js-seven font-mono">
            <a name="seatbelt.Namespace">{{ highlight "go" "func (app *seatbelt.App) Namespace(pattern string, fn func(app *seatbelt.App)) *seatbelt.App" }}</a>
          </h3>

          <div class="invisible group-hover:visible ml-2">
            <a href="#seatbelt.Namespace" class="block">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
              </svg>
            </a>
          </div>
        </div>

        <p class="text-slate-600 text-base leading-relaxed mb-4">TODO</p>
      </section>
    </main>
  </div>
</div>

<script>
  (() => {
    "use strict"

    let articleArr = document.querySelectorAll(".js-symbol-title")

    let io = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          let target = entry.target.classList[1]
          document.querySelectorAll('.js-toc').forEach(n => {
            n.classList.remove("bg-slate-200", "border-rounded")
          })
          document.querySelector(`.js-toc.${target}`).classList.add("bg-slate-200", "border-rounded")
        }
      })
    }, {
      root: null,
      rootMargin: "0px",
      threshold: 0
    })

    articleArr.forEach(article => io.observe(article))
  })()
</script>
